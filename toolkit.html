<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Site Selection Toolkit | 12-Step Framework & Property Profile</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <style>
    * { font-family: 'DM Sans', sans-serif; }
    .mono { font-family: 'JetBrains Mono', monospace; }
    .step-card { transition: all 0.3s ease; }
    .step-card:hover { transform: translateY(-2px); }
    .expand-content { animation: slideDown 0.3s ease-out; }
    @keyframes slideDown {
      from { opacity: 0; max-height: 0; }
      to { opacity: 1; max-height: 8000px; }
    }
    .nav-item.active { background: linear-gradient(135deg, #EBF5FF 0%, #E0F2FE 100%); }
    .phase-badge { font-size: 10px; letter-spacing: 0.5px; }
    .progress-bar { transition: width 0.15s ease; }
    ::-webkit-scrollbar { width: 8px; height: 8px; }
    ::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 4px; }
    ::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #a1a1a1; }
    .gradient-text { background: linear-gradient(135deg, #1E40AF 0%, #059669 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .example-table { font-size: 12px; }
    .example-table th { background: #f8fafc; font-weight: 600; text-transform: uppercase; font-size: 10px; letter-spacing: 0.5px; }
    .example-table td, .example-table th { padding: 8px 12px; border-bottom: 1px solid #e2e8f0; }
    .example-table tr:last-child td { border-bottom: none; }
    .example-badge { display: inline-flex; align-items: center; gap: 4px; padding: 2px 8px; border-radius: 9999px; font-size: 10px; font-weight: 600; }
    .profile-field { 
      background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
      border: 1px solid #e2e8f0;
      border-radius: 8px;
      padding: 12px 16px;
      margin-bottom: 8px;
      transition: all 0.2s ease;
    }
    .profile-field:hover {
      border-color: #cbd5e1;
      box-shadow: 0 2px 4px rgba(0,0,0,0.05);
    }
    .field-label {
      font-size: 11px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: #64748b;
      margin-bottom: 4px;
    }
    .field-value {
      font-family: 'JetBrains Mono', monospace;
      font-size: 14px;
      color: #1e293b;
    }
    .field-directive {
      font-size: 11px;
      color: #94a3b8;
      font-style: italic;
      margin-top: 4px;
    }
    .module-header {
      background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
      color: white;
      padding: 16px 20px;
      border-radius: 12px 12px 0 0;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    .module-content {
      background: white;
      border: 1px solid #e2e8f0;
      border-top: none;
      border-radius: 0 0 12px 12px;
      padding: 20px;
    }
    .section-divider {
      height: 2px;
      background: linear-gradient(90deg, transparent, #e2e8f0, transparent);
      margin: 24px 0;
    }
    .data-source-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 9px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }
    .source-costar { background: #dbeafe; color: #1e40af; }
    .source-centercheck { background: #dcfce7; color: #166534; }
    .source-census { background: #fef3c7; color: #92400e; }
    .source-google { background: #fee2e2; color: #991b1b; }
    .source-calculated { background: #f3e8ff; color: #7c3aed; }
    .checkbox-field {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 10px;
      background: #f1f5f9;
      border-radius: 6px;
      font-size: 12px;
      margin: 2px;
    }
    .checkbox-field.selected {
      background: #dbeafe;
      color: #1e40af;
      font-weight: 600;
    }
    .formula-box {
      background: linear-gradient(135deg, #faf5ff 0%, #f3e8ff 100%);
      border: 1px solid #e9d5ff;
      border-radius: 8px;
      padding: 12px 16px;
      font-family: 'JetBrains Mono', monospace;
      font-size: 12px;
      color: #6b21a8;
    }
    .integration-flow {
      background: linear-gradient(135deg, #f0fdf4 0%, #dcfce7 100%);
      border: 1px solid #bbf7d0;
      border-radius: 8px;
      padding: 16px;
    }
    .tab-btn {
      padding: 8px 16px;
      border-radius: 8px;
      font-size: 13px;
      font-weight: 500;
      transition: all 0.2s;
    }
    .tab-btn.active {
      background: linear-gradient(135deg, #1e40af 0%, #059669 100%);
      color: white;
    }
    .tab-btn:not(.active) {
      background: #f1f5f9;
      color: #64748b;
    }
    .tab-btn:not(.active):hover {
      background: #e2e8f0;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-slate-50 to-slate-100 min-h-screen">
  <!-- Progress Bar -->
  <div id="progressBar" class="fixed top-0 left-0 right-0 h-1 bg-gray-200 z-50">
    <div class="progress-bar h-full bg-gradient-to-r from-blue-600 to-emerald-500" style="width: 0%"></div>
  </div>

  <!-- Header -->
  <header class="sticky top-1 z-40 bg-white/95 backdrop-blur-sm shadow-sm border-b border-gray-100">
    <div class="max-w-7xl mx-auto px-4 py-3">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-3">
          <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-blue-600 to-emerald-500 flex items-center justify-center">
            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
          </div>
          <div>
            <h1 class="text-lg font-bold text-gray-800">Site Selection Toolkit</h1>
            <p class="text-xs text-gray-500">12-Step Framework & Property Profile</p>
          </div>
        </div>
        
        <!-- Desktop Nav -->
        <nav id="desktopNav" class="hidden md:flex items-center gap-1">
          <button onclick="showSection('overview')" class="nav-item flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-all" data-section="overview">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
            Overview
          </button>
          <button onclick="showSection('process')" class="nav-item flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-all" data-section="process">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
            12-Step Process
          </button>
          <button onclick="showSection('profile')" class="nav-item flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-all" data-section="profile">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
            Property Profile
          </button>
          <button onclick="showSection('maps')" class="nav-item flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-all" data-section="maps">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path></svg>
            Map Catalog
          </button>
          <button onclick="showSection('formulas')" class="nav-item flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-all" data-section="formulas">
            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
            Formulas
          </button>
        </nav>

        <!-- Mobile Menu Button -->
        <button onclick="toggleMobileMenu()" class="md:hidden p-2 rounded-lg hover:bg-gray-100">
          <svg id="menuIcon" class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg>
          <svg id="closeIcon" class="w-6 h-6 hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>
        </button>
      </div>

      <!-- Mobile Nav -->
      <nav id="mobileNav" class="hidden md:hidden pt-3 pb-2 border-t border-gray-100 mt-3 space-y-1">
        <button onclick="showSection('overview'); toggleMobileMenu();" class="nav-item flex items-center gap-2 w-full px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-all" data-section="overview">Overview</button>
        <button onclick="showSection('process'); toggleMobileMenu();" class="nav-item flex items-center gap-2 w-full px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-all" data-section="process">12-Step Process</button>
        <button onclick="showSection('profile'); toggleMobileMenu();" class="nav-item flex items-center gap-2 w-full px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-all" data-section="profile">Property Profile</button>
        <button onclick="showSection('maps'); toggleMobileMenu();" class="nav-item flex items-center gap-2 w-full px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-all" data-section="maps">Map Catalog</button>
        <button onclick="showSection('formulas'); toggleMobileMenu();" class="nav-item flex items-center gap-2 w-full px-3 py-2 rounded-lg text-sm font-medium text-gray-600 hover:bg-gray-50 transition-all" data-section="formulas">Formulas</button>
      </nav>
    </div>
  </header>

  <!-- Main Content -->
  <main class="max-w-6xl mx-auto px-4 py-8">
    <!-- Overview Section -->
    <section id="section-overview" class="space-y-8">
      <!-- Hero -->
      <div class="text-center py-12">
        <div class="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-blue-50 text-blue-700 text-sm font-medium mb-6">
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
          Transforming Abstract Numbers into Decision-Grade Insight
        </div>
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">
          Comprehensive Retail<br /><span class="gradient-text">Site Selection Framework</span>
        </h1>
        <p class="text-lg text-gray-600 max-w-2xl mx-auto mb-8">
          A 12-step process for data-driven location intelligence, with a standardized Master Property Profile template for consistent data collection and analysis.
        </p>
        <div class="flex flex-wrap justify-center gap-3">
          <button onclick="showSection('process')" class="inline-flex items-center gap-2 px-6 py-3 bg-gradient-to-r from-blue-600 to-emerald-500 text-white font-semibold rounded-xl hover:shadow-lg transition-all">
            12-Step Framework
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M14 5l7 7m0 0l-7 7m7-7H3"></path></svg>
          </button>
          <button onclick="showSection('profile')" class="inline-flex items-center gap-2 px-6 py-3 bg-white border-2 border-gray-200 text-gray-700 font-semibold rounded-xl hover:border-blue-300 hover:shadow-lg transition-all">
            Property Profile Template
            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
          </button>
        </div>
      </div>

      <!-- Process Flow Visual -->
      <div class="bg-white rounded-2xl shadow-lg p-6 overflow-x-auto">
        <h2 class="text-lg font-bold text-gray-800 mb-4">Framework Overview</h2>
        <div class="flex gap-2 min-w-max pb-2">
          <div class="flex-1 min-w-[100px]">
            <div class="text-xs font-bold text-white text-center py-1 rounded-t-lg" style="background-color: #1E3A5F">Foundation</div>
            <div class="border border-t-0 border-gray-200 rounded-b-lg p-2"><div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">1. Market Definition</div></div>
          </div>
          <div class="flex-1 min-w-[100px]">
            <div class="text-xs font-bold text-white text-center py-1 rounded-t-lg" style="background-color: #2E7D32">Data Collection</div>
            <div class="border border-t-0 border-gray-200 rounded-b-lg p-2 space-y-1">
              <div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">2. Competitive Intel</div>
              <div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">3. Trade Area</div>
            </div>
          </div>
          <div class="flex-1 min-w-[100px]">
            <div class="text-xs font-bold text-white text-center py-1 rounded-t-lg" style="background-color: #7B1FA2">Analysis</div>
            <div class="border border-t-0 border-gray-200 rounded-b-lg p-2 space-y-1">
              <div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">4. Demographics</div>
              <div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">5. Journey Mapping</div>
              <div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">6. Normalization</div>
            </div>
          </div>
          <div class="flex-1 min-w-[100px]">
            <div class="text-xs font-bold text-white text-center py-1 rounded-t-lg" style="background-color: #C62828">Strategy</div>
            <div class="border border-t-0 border-gray-200 rounded-b-lg p-2 space-y-1">
              <div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">7. Positioning</div>
              <div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">8. Screening</div>
            </div>
          </div>
          <div class="flex-1 min-w-[100px]">
            <div class="text-xs font-bold text-white text-center py-1 rounded-t-lg" style="background-color: #1565C0">Financial</div>
            <div class="border border-t-0 border-gray-200 rounded-b-lg p-2"><div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">9. Revenue Model</div></div>
          </div>
          <div class="flex-1 min-w-[100px]">
            <div class="text-xs font-bold text-white text-center py-1 rounded-t-lg" style="background-color: #FF6F00">Decision</div>
            <div class="border border-t-0 border-gray-200 rounded-b-lg p-2 space-y-1">
              <div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">10. Site Scoring</div>
              <div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">11. Cannibalization</div>
            </div>
          </div>
          <div class="flex-1 min-w-[100px]">
            <div class="text-xs font-bold text-white text-center py-1 rounded-t-lg" style="background-color: #263238">Execution</div>
            <div class="border border-t-0 border-gray-200 rounded-b-lg p-2"><div class="text-xs p-1.5 bg-gray-50 rounded text-center text-gray-700">12. Implementation</div></div>
          </div>
        </div>
      </div>

      <!-- Data Integration Visual -->
      <div class="bg-white rounded-2xl shadow-lg p-6">
        <h2 class="text-lg font-bold text-gray-800 mb-4">Data Source Integration</h2>
        <div class="integration-flow">
          <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white rounded-lg p-4 text-center shadow-sm">
              <div class="data-source-badge source-google mb-2">Google Maps</div>
              <p class="text-xs text-gray-600">Ratings, Hours, Place Data</p>
            </div>
            <div class="bg-white rounded-lg p-4 text-center shadow-sm">
              <div class="data-source-badge source-costar mb-2">CoStar</div>
              <p class="text-xs text-gray-600">Property, Market, Traffic</p>
            </div>
            <div class="bg-white rounded-lg p-4 text-center shadow-sm">
              <div class="data-source-badge source-centercheck mb-2">CenterCheck</div>
              <p class="text-xs text-gray-600">Sales, Customers, Journeys</p>
            </div>
            <div class="bg-white rounded-lg p-4 text-center shadow-sm">
              <div class="data-source-badge source-census mb-2">Census/ESRI</div>
              <p class="text-xs text-gray-600">Demographics, Population</p>
            </div>
          </div>
          <div class="text-center">
            <svg class="w-6 h-6 mx-auto text-emerald-600 mb-2" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"></path></svg>
            <div class="inline-block bg-gradient-to-r from-blue-600 to-emerald-500 text-white px-6 py-3 rounded-xl font-bold">
              Master Property Profile → DASSB Model → Site Rankings
            </div>
          </div>
        </div>
      </div>

      <!-- Quick Stats -->
      <div class="grid grid-cols-2 md:grid-cols-5 gap-4">
        <div class="bg-gradient-to-br from-blue-600 to-blue-700 rounded-xl p-5 text-white">
          <div class="text-3xl font-bold">12</div>
          <div class="text-sm opacity-80">Strategic Steps</div>
        </div>
        <div class="bg-gradient-to-br from-emerald-600 to-emerald-700 rounded-xl p-5 text-white">
          <div class="text-3xl font-bold">14</div>
          <div class="text-sm opacity-80">Profile Modules</div>
        </div>
        <div class="bg-gradient-to-br from-purple-600 to-purple-700 rounded-xl p-5 text-white">
          <div class="text-3xl font-bold">200+</div>
          <div class="text-sm opacity-80">Data Fields</div>
        </div>
        <div class="bg-gradient-to-br from-orange-600 to-orange-700 rounded-xl p-5 text-white">
          <div class="text-3xl font-bold">17+</div>
          <div class="text-sm opacity-80">Map Types</div>
        </div>
        <div class="bg-gradient-to-br from-slate-600 to-slate-700 rounded-xl p-5 text-white">
          <div class="text-3xl font-bold">4</div>
          <div class="text-sm opacity-80">Data Sources</div>
        </div>
      </div>
    </section>

    <!-- Process Section -->
    <section id="section-process" class="hidden space-y-6">
      <div class="flex items-center justify-between mb-6">
        <div>
          <h2 class="text-2xl font-bold text-gray-800">12-Step Process</h2>
          <p class="text-gray-600">Click any step to expand detailed methodology with real-world examples</p>
        </div>
      </div>
      <div id="stepsContainer"></div>
    </section>

    <!-- Property Profile Section -->
    <section id="section-profile" class="hidden space-y-6">
      <div class="mb-6">
        <div class="flex items-center gap-3 mb-2">
          <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-blue-600 to-emerald-500 flex items-center justify-center">
            <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
          </div>
          <div>
            <h2 class="text-2xl font-bold text-gray-800">Master Property Profile Template</h2>
            <p class="text-gray-600">Standardized data schema for consistent location intelligence</p>
          </div>
        </div>
        
        <!-- Module Navigation Tabs -->
        <div class="flex flex-wrap gap-2 mt-6 mb-4">
          <button onclick="showProfileModule('all')" class="tab-btn active" data-module="all">All Modules</button>
          <button onclick="showProfileModule('identity')" class="tab-btn" data-module="identity">Identity</button>
          <button onclick="showProfileModule('physical')" class="tab-btn" data-module="physical">Physical</button>
          <button onclick="showProfileModule('location')" class="tab-btn" data-module="location">Location</button>
          <button onclick="showProfileModule('demographics')" class="tab-btn" data-module="demographics">Demographics</button>
          <button onclick="showProfileModule('performance')" class="tab-btn" data-module="performance">Performance</button>
          <button onclick="showProfileModule('financial')" class="tab-btn" data-module="financial">Financial</button>
          <button onclick="showProfileModule('calculated')" class="tab-btn" data-module="calculated">Calculated</button>
        </div>
      </div>
      
      <div id="profileContainer"></div>
    </section>

    <!-- Maps Section -->
    <section id="section-maps" class="hidden space-y-6">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-800">Interactive Map Catalog</h2>
        <p class="text-gray-600">Visualizations that show how money and people move through space</p>
      </div>
      <div id="mapCatalogContainer"></div>
    </section>

    <!-- Formulas Section -->
    <section id="section-formulas" class="hidden space-y-6">
      <div class="mb-6">
        <h2 class="text-2xl font-bold text-gray-800">Key Formulas & Calculations</h2>
        <p class="text-gray-600">Essential equations for site selection analysis</p>
      </div>
      <div id="formulasContainer"></div>
    </section>
  </main>

  <!-- Footer -->
  <footer class="border-t border-gray-200 bg-white mt-12">
    <div class="max-w-6xl mx-auto px-4 py-8">
      <div class="text-center text-gray-500 text-sm">
        <p class="font-medium text-gray-700 mb-1">Windfield Real Estate & Development</p>
        <p>Comprehensive Retail Site Selection Framework & Master Property Profile Template v1.0</p>
      </div>
    </div>
  </footer>

  <script>
    // ============================================
    // DATA DEFINITIONS
    // ============================================
    
    const steps = [
      { 
        id: 1, 
        title: "Market Definition & Boundary Setting", 
        color: "#1E3A5F", 
        phase: "Foundation", 
        keyAction: "Define the geographic market boundaries and establish the analysis perimeter for site selection", 
        targetedInsight: "Where does the addressable market begin and end? What is the competitive landscape footprint?", 
        input: "Target market geography, existing brand footprint, competitor location inventory, population centers, major traffic corridors", 
        output: "Defined market boundary polygon, list of municipalities/counties included, primary and secondary market zones", 
        deliverable: "Market Boundary Map with zone classifications (Core Market, Expansion Market, Watch Market)", 
        directive: "Establish clear geographic parameters before any analysis begins. Define both the competitive market and the addressable market.", 
        mapType: "Choropleth with Boundary Overlay", 
        bestFor: "Initial stakeholder alignment, establishing analysis scope"
      },
      { 
        id: 2, 
        title: "Competitive Intelligence Gathering", 
        color: "#2E7D32", 
        phase: "Data Collection", 
        keyAction: "Compile comprehensive competitor location inventory and obtain transaction-level performance data for proxy analysis", 
        targetedInsight: "Where are competitors located, how are they performing, and what does their success/failure tell us about market demand?", 
        input: "Competitor brand list, location databases, CenterCheck or similar transaction data reports, store format classifications", 
        output: "Complete competitor location database with coordinates, performance metrics (sales, transactions, YoY growth), brand rank percentiles", 
        deliverable: "Competitor Performance Database with 15+ data points per location", 
        directive: "Gather data from at least 8-10 comparable competitor locations to establish statistical validity.", 
        mapType: "Multi-Variable Bubble Map", 
        bestFor: "Executive overview of competitive landscape"
      },
      { 
        id: 3, 
        title: "Trade Area Analysis", 
        color: "#0277BD", 
        phase: "Data Collection", 
        keyAction: "Map the geographic capture zones for each competitor location and analyze sales concentration patterns", 
        targetedInsight: "How far do customers travel to reach each location? Where is demand concentrated vs. diffuse?", 
        input: "Sales by zip code data, zip code boundary shapefiles, road network data, competitor coordinates", 
        output: "Trade area polygons for each location, sales concentration heat maps, drive-time isochrone overlays", 
        deliverable: "Trade Area Comparison Report showing geographic reach and concentration risk scores", 
        directive: "Calculate trade area metrics: Number of active zip codes, Sales concentration in top zip, Sales per zip code efficiency.", 
        mapType: "Choropleth with 3D Extrusion", 
        bestFor: "Understanding geographic sales patterns"
      },
      { 
        id: 4, 
        title: "Demographic Profiling", 
        color: "#7B1FA2", 
        phase: "Analysis", 
        keyAction: "Extract and compare shopper demographics vs. resident demographics to identify target customer profiles", 
        targetedInsight: "Who actually shops at successful locations? Does shopper profile match or diverge from local population?", 
        input: "CenterCheck demographic data, Census demographic data, location performance metrics", 
        output: "Demographic comparison matrices, shopper vs. resident variance scores, demographic-performance correlation analysis", 
        deliverable: "Demographic Alignment Report with target customer profile and market fit scores", 
        directive: "Compare shopper demographics to resident demographics across 4 dimensions: Age, Income, Gender, Ethnicity.", 
        mapType: "Bivariate Choropleth with Alert Flags", 
        bestFor: "Identifying underserved customer segments"
      },
      { 
        id: 5, 
        title: "Customer Journey Mapping", 
        color: "#E65100", 
        phase: "Analysis", 
        keyAction: "Analyze cardholder spend journeys to understand where customers shop before and after visiting each location", 
        targetedInsight: "What is the shopping context? Is this a standalone trip or part of a broader shopping journey?", 
        input: "Cardholder spend journey data, retailer category classifications, co-tenant location data", 
        output: "Customer journey flow diagrams, co-shopping percentages, trip chain analysis", 
        deliverable: "Customer Journey Analysis showing trip type classification and optimal co-tenancy recommendations", 
        directive: "Extract journey data to classify each location by trip type: DESTINATION (>90% standalone) vs. TRIP-CHAIN (>10% co-shopping).", 
        mapType: "Sankey Diagram Overlaid on Map", 
        bestFor: "Understanding customer shopping context"
      },
      { 
        id: 6, 
        title: "Data Normalization & Benchmarking", 
        color: "#00695C", 
        phase: "Analysis", 
        keyAction: "Normalize raw performance data to enable apples-to-apples comparison across different markets", 
        targetedInsight: "Which locations are truly outperforming given their market context?", 
        input: "Raw sales/transaction data, trade area population, number of zip codes served, store square footage", 
        output: "Normalized performance metrics (Sales Per Capita, Sales Per Zip, Transaction Density)", 
        deliverable: "Normalized Performance Dashboard with location rankings by efficiency metrics", 
        directive: "Calculate minimum 5 normalization metrics for each location. Rank locations by each metric.", 
        mapType: "Scatter Plot Overlaid on Geographic Map", 
        bestFor: "Identifying true efficiency leaders"
      },
      { 
        id: 7, 
        title: "Competitive Positioning Strategy", 
        color: "#C62828", 
        phase: "Strategy", 
        keyAction: "Analyze competitor proximity patterns to determine optimal distance from existing competitors", 
        targetedInsight: "How close is too close? What is the 'Goldilocks zone' of competitor proximity?", 
        input: "Competitor coordinates, performance data by proximity band, brand-specific co-location history", 
        output: "Optimal proximity ranges by competitor type, competitive pressure scores", 
        deliverable: "Competitive Positioning Map with proximity bands and recommended placement zones", 
        directive: "Analyze historical performance by competitor proximity: <0.5 mile = High pressure; 1.0-1.5 miles = Optimal (SWEET SPOT).", 
        mapType: "Concentric Ring Buffer Map", 
        bestFor: "Strategic site placement decisions"
      },
      { 
        id: 8, 
        title: "Site Identification & Screening", 
        color: "#4527A0", 
        phase: "Strategy", 
        keyAction: "Apply location criteria filters to identify potential sites and screen based on primary requirements", 
        targetedInsight: "Which specific parcels meet minimum requirements for consideration?", 
        input: "Commercial real estate listings, zoning maps, traffic count data, parcel data", 
        output: "Qualified site inventory with basic metrics, disqualified sites with rejection reasons", 
        deliverable: "Site Screening Matrix showing all potential sites with pass/fail status on each criterion", 
        directive: "Apply minimum threshold filters: Zoning permits use, Traffic count meets minimum (20,000+ VPD), Lot size, Competitive proximity.", 
        mapType: "Filtered Point Map with Pass/Fail Coloring", 
        bestFor: "Pipeline management"
      },
      { 
        id: 9, 
        title: "Revenue Projection Modeling", 
        color: "#1565C0", 
        phase: "Financial", 
        keyAction: "Build revenue projections for qualified sites using competitor performance data as proxy", 
        targetedInsight: "What annual revenue can each site realistically generate?", 
        input: "Competitor performance data, translation factors, site-specific traffic counts, demographic multipliers", 
        output: "Year 1, Year 2, Year 3 revenue projections for each site, projection confidence levels", 
        deliverable: "Revenue Projection Model with sensitivity analysis showing upside/downside scenarios", 
        directive: "Apply the Translation Factor method: Client National Avg ÷ Competitor National Avg × Local Performance × Adjustments.", 
        mapType: "Graduated Symbol Map with Revenue Coloring", 
        bestFor: "Investment prioritization"
      },
      { 
        id: 10, 
        title: "Weighted Site Scoring", 
        color: "#FF6F00", 
        phase: "Decision", 
        keyAction: "Apply a weighted multi-criteria scoring framework to rank all qualified sites", 
        targetedInsight: "When all factors are considered with appropriate weighting, which sites rise to the top?", 
        input: "All normalized metrics, revenue projections, qualitative assessments, strategic factors", 
        output: "Composite scores (0-100) for each site, component score breakdowns, tier classifications", 
        deliverable: "Site Ranking Report with scored comparison matrix and tier recommendations", 
        directive: "Apply weighted scoring: YoY Growth 25%, AOV 20%, Brand Rank 20%, Customer Growth 15%, Trade Area 10%, Concentration 10%.", 
        mapType: "Dynamic Scoring Map with Adjustable Weights", 
        bestFor: "Stakeholder decision workshops"
      },
      { 
        id: 11, 
        title: "Cannibalization & Market Void Analysis", 
        color: "#5D4037", 
        phase: "Decision", 
        keyAction: "Analyze potential trade area overlap to prevent self-cannibalization while identifying market voids", 
        targetedInsight: "Will new locations steal sales from existing units? Where do genuine market voids exist?", 
        input: "Trade area polygons for all locations, sales by zip code, drive-time isochrones", 
        output: "Cannibalization risk scores, overlap percentages, market void polygons", 
        deliverable: "Cannibalization Risk Report with go/no-go recommendations and market void opportunity map", 
        directive: "Calculate trade area overlap between proposed sites and existing locations. Flag overlaps >20% as high risk.", 
        mapType: "Animated Slider Comparison Map", 
        bestFor: "Expansion planning justification"
      },
      { 
        id: 12, 
        title: "Final Recommendation & Implementation", 
        color: "#263238", 
        phase: "Execution", 
        keyAction: "Synthesize all analysis into tier-prioritized site recommendations with acquisition timeline", 
        targetedInsight: "Which sites should be pursued immediately vs. held for future phases?", 
        input: "Weighted site scores, revenue projections, cannibalization analysis, real estate availability", 
        output: "Tiered site recommendations, phased acquisition timeline, success metrics definitions", 
        deliverable: "Executive Site Selection Report with strategic narrative, financial projections, implementation roadmap", 
        directive: "Structure: Tier 1A (Immediate), Tier 1B (Fast Follow), Tier 2 (Phase 2 Pipeline), Tier 3 (Watch List). Include 30/60/90-day action items.", 
        mapType: "Scrollytelling Narrative Map", 
        bestFor: "Board presentations, investment committee reviews"
      }
    ];

    const profileModules = [
      {
        id: 1,
        title: "Property Identity",
        category: "identity",
        icon: "M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2",
        color: "#1E40AF",
        sources: ["CoStar", "Google"],
        sections: [
          {
            title: "1.1 Core Identification",
            fields: [
              { label: "Windfield Property ID", value: "WF-NE-000147", directive: "Format: WF-[State 2-letter]-[6-digit sequential]. Auto-generated upon profile creation." },
              { label: "Property Type", value: "Competitor Location", directive: "Select: Prospective Site | Competitor Location | Client Existing | Benchmark Comparable" },
              { label: "Property Status", value: "Active/Operating", directive: "Select: Active/Operating | Available (Sale) | Available (Lease) | Under Contract | Under Development | Closed" },
              { label: "Asset Class", value: "Retail - Freestanding", directive: "Select: Land | Freestanding | Inline | Pad Site | Endcap | Office | Mixed Use" },
              { label: "CoStar Property ID", value: "8847291", directive: "Enter CoStar's unique property identifier from property detail page" },
              { label: "Google Place ID", value: "ChIJN1t_tDeuEmsRUsoyG83frY4", directive: "Extract from Google Maps URL or Places API" },
              { label: "CenterCheck Location ID", value: "CC-STB-156MAPLE", directive: "From CenterCheck report header" }
            ]
          },
          {
            title: "1.2 Address & Coordinates",
            fields: [
              { label: "Property Name", value: "Starbucks - 156th & Maple", directive: "Brand name + location descriptor" },
              { label: "Street Address", value: "15602 Maple Street", directive: "Street number and name only" },
              { label: "City", value: "Omaha", directive: "City name" },
              { label: "State", value: "NE", directive: "2-letter state code" },
              { label: "ZIP Code", value: "68116", directive: "5-digit ZIP" },
              { label: "County", value: "Douglas County", directive: "Full county name" },
              { label: "Latitude", value: "41.2847", directive: "Decimal degrees, 4 decimal places minimum" },
              { label: "Longitude", value: "-96.1172", directive: "Decimal degrees, negative for West" },
              { label: "Census Tract", value: "55.04", directive: "From Census TIGER/Line files" },
              { label: "CBSA Code", value: "36540", directive: "Core Based Statistical Area code" },
              { label: "CBSA Name", value: "Omaha-Council Bluffs, NE-IA", directive: "Metro area name" }
            ]
          },
          {
            title: "1.3 Business Identity (Operating Locations)",
            fields: [
              { label: "Brand Name", value: "Starbucks", directive: "Corporate brand name" },
              { label: "Brand Category", value: "Coffee / Specialty Beverage", directive: "Primary business category" },
              { label: "Store Number", value: "12847", directive: "Corporate store identifier" },
              { label: "Franchise/Corporate", value: "Corporate", directive: "Select: Franchise | Corporate" },
              { label: "Phone Number", value: "(402) 555-0147", directive: "Primary business phone" },
              { label: "Opening Date", value: "2019-03-15", directive: "Format: YYYY-MM-DD" },
              { label: "Google Rating", value: "4.3 / 5.0", directive: "Current Google rating" },
              { label: "Google Review Count", value: "847", directive: "Total number of reviews" },
              { label: "Service Options", value: "Dine-in, Drive-through, Pickup", directive: "Check all that apply" }
            ]
          }
        ]
      },
      {
        id: 2,
        title: "Physical Attributes",
        category: "physical",
        icon: "M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4",
        color: "#059669",
        sources: ["CoStar"],
        sections: [
          {
            title: "2.1 Land Characteristics",
            fields: [
              { label: "Land Acres (Gross)", value: "0.87 AC", directive: "Total parcel acreage before any deductions" },
              { label: "Land Acres (Net)", value: "0.82 AC", directive: "Usable acreage after easements, setbacks" },
              { label: "Land SF (Gross)", value: "37,897 SF", directive: "Gross acreage × 43,560" },
              { label: "Topography", value: "Level", directive: "Select: Level | Slightly Sloped | Moderately Sloped | Steep" },
              { label: "Shape", value: "Corner", directive: "Select: Regular | Irregular | Flag Lot | Corner" },
              { label: "Corner Lot", value: "Yes", directive: "Yes if site has 2+ street frontages at intersection" },
              { label: "Primary Frontage Street", value: "Maple Street", directive: "Highest traffic street name" },
              { label: "Primary Frontage Feet", value: "185 LF", directive: "Linear feet along primary street" },
              { label: "Secondary Frontage Street", value: "156th Street", directive: "Second street if corner lot" },
              { label: "Secondary Frontage Feet", value: "210 LF", directive: "Linear feet along secondary street" }
            ]
          },
          {
            title: "2.2 Building Characteristics",
            fields: [
              { label: "Building SF (RBA)", value: "2,450 SF", directive: "Rentable Building Area from CoStar" },
              { label: "Building SF (GLA)", value: "2,380 SF", directive: "Gross Leasable Area" },
              { label: "Number of Stories", value: "1", directive: "Total floors including basement if applicable" },
              { label: "Year Built", value: "2019", directive: "Original construction year" },
              { label: "Year Renovated", value: "—", directive: "Most recent significant renovation" },
              { label: "Building Class", value: "A", directive: "Select: A | B | C based on CoStar classification" },
              { label: "Construction Type", value: "Wood Frame / Stucco", directive: "Primary structural and exterior materials" },
              { label: "Condition", value: "Excellent", directive: "Select: Excellent | Good | Fair | Poor" }
            ]
          },
          {
            title: "2.3 Parking & Access",
            fields: [
              { label: "Total Parking Spaces", value: "24", directive: "Count all dedicated spaces" },
              { label: "Parking Ratio", value: "9.8 / 1,000 SF", directive: "Total spaces ÷ (Building SF / 1,000)" },
              { label: "Drive-Through Lanes", value: "2", directive: "Number of service lanes" },
              { label: "Drive-Through Stacking", value: "12 cars", directive: "Maximum vehicle queue capacity" },
              { label: "Primary Access Point", value: "Maple Street (signalized)", directive: "Main entrance street and signal status" },
              { label: "Secondary Access Point", value: "156th Street (right-in/right-out)", directive: "Additional access and turn restrictions" },
              { label: "Ingress Type", value: "Full Access (All Turns)", directive: "Select: Full Access | Right-In/Right-Out | Signalized" }
            ]
          },
          {
            title: "2.4 Zoning & Entitlements",
            fields: [
              { label: "Zoning Code", value: "C-2", directive: "Local zoning designation" },
              { label: "Zoning Description", value: "General Commercial", directive: "Plain language zoning category" },
              { label: "Municipality", value: "City of Omaha", directive: "Governing jurisdiction" },
              { label: "Retail Permitted", value: "Yes", directive: "Select: Yes | No | Conditional" },
              { label: "Drive-Through Permitted", value: "Yes", directive: "Select: Yes | No | Conditional" },
              { label: "Max Building Height", value: "45 feet", directive: "Zoning height restriction" },
              { label: "Max FAR", value: "0.50", directive: "Maximum Floor Area Ratio allowed" },
              { label: "Min Parking Required", value: "5.0 / 1,000 SF", directive: "Code-required parking ratio" },
              { label: "Opportunity Zone", value: "No", directive: "Yes if in designated Opportunity Zone" }
            ]
          }
        ]
      },
      {
        id: 3,
        title: "Location Context",
        category: "location",
        icon: "M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z M15 11a3 3 0 11-6 0 3 3 0 016 0z",
        color: "#7C3AED",
        sources: ["CoStar", "Census"],
        sections: [
          {
            title: "3.1 Market Geography",
            fields: [
              { label: "CoStar Market", value: "Omaha", directive: "CoStar primary market name" },
              { label: "CoStar Submarket", value: "West Omaha", directive: "CoStar submarket classification" },
              { label: "Location Type", value: "Suburban", directive: "Select: Urban Core | Urban | Suburban | Rural" },
              { label: "Retail Node Type", value: "Freestanding", directive: "Select: Mall | Power Center | Lifestyle | Community | Neighborhood | Strip | Freestanding | Downtown" },
              { label: "Trade Area Type", value: "Community", directive: "Select: Convenience | Neighborhood | Community | Regional | Super Regional" },
              { label: "Walk Score", value: "42 / 100", directive: "From WalkScore.com" },
              { label: "Transit Score", value: "28 / 100", directive: "From WalkScore.com" }
            ]
          },
          {
            title: "3.2 Proximity Analysis",
            fields: [
              { label: "Nearest Airport", value: "Eppley Airfield (OMA)", directive: "Commercial airport name and code" },
              { label: "Airport Distance", value: "12.4 miles", directive: "Driving distance" },
              { label: "Nearest Interstate", value: "I-680", directive: "Interstate highway designation" },
              { label: "Interstate Distance", value: "0.8 miles", directive: "Distance to nearest on-ramp" },
              { label: "Downtown Distance", value: "14.2 miles", directive: "Distance to CBD" },
              { label: "Major Employer #1", value: "Methodist Hospital", directive: "Largest employer within 1 mile" },
              { label: "Major Employer Distance", value: "0.6 miles", directive: "Distance to major employer" },
              { label: "Nearest Grocery", value: "Hy-Vee", directive: "Closest grocery anchor" },
              { label: "Grocery Distance", value: "0.3 miles", directive: "Distance to grocery" }
            ]
          },
          {
            title: "3.3 Co-Tenancy & Adjacent Uses",
            fields: [
              { label: "Adjacent Tenant #1", value: "Chipotle", directive: "Nearest complementary tenant" },
              { label: "Adjacent #1 Distance", value: "150 feet", directive: "Distance in feet" },
              { label: "Adjacent Tenant #2", value: "Panera Bread", directive: "Second nearest tenant" },
              { label: "Adjacent #2 Distance", value: "320 feet", directive: "Distance in feet" },
              { label: "Adjacent Tenant #3", value: "CVS Pharmacy", directive: "Third nearest tenant" },
              { label: "Adjacent #3 Distance", value: "480 feet", directive: "Distance in feet" },
              { label: "Co-Tenancy Score", value: "78 / 100", directive: "DASSB calculated score based on synergy analysis" },
              { label: "National Tenants Count", value: "8", directive: "Count of national brands within 0.25 miles" }
            ]
          },
          {
            title: "3.4 Competitive Proximity",
            fields: [
              { label: "Nearest Primary Competitor", value: "Starbucks - 144th & Dodge", directive: "Same category competitor" },
              { label: "Primary Comp Distance", value: "1.2 miles", directive: "Distance to nearest same-brand/category" },
              { label: "Competitors Within 0.5 mi", value: "0", directive: "Count of same-category competitors" },
              { label: "Competitors Within 1.0 mi", value: "1", directive: "Count of same-category competitors" },
              { label: "Competitors Within 2.0 mi", value: "4", directive: "Count of same-category competitors" },
              { label: "Competitive Pressure Band", value: "Optimal (1.0-1.5 mi)", directive: "Select: Very High (<0.5) | High (0.5-1.0) | Optimal (1.0-1.5) | Moderate (1.5-2.0) | Low (>2.0)" },
              { label: "Competitive Pressure Score", value: "72 / 100", directive: "DASSB calculated - higher is less pressure" }
            ]
          }
        ]
      },
      {
        id: 4,
        title: "Market Position",
        category: "location",
        icon: "M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z",
        color: "#DC2626",
        sources: ["CoStar"],
        sections: [
          {
            title: "4.1 Market Conditions",
            fields: [
              { label: "Submarket Vacancy Rate", value: "4.2%", directive: "Current retail vacancy in submarket" },
              { label: "Vacancy YoY Change", value: "-0.8%", directive: "Change from prior year (negative = improving)" },
              { label: "Submarket Asking Rent", value: "$24.50/SF", directive: "Average NNN asking rent" },
              { label: "Rent YoY Change", value: "+3.2%", directive: "Rent growth from prior year" },
              { label: "SF Leased (12 mo)", value: "287,000 SF", directive: "Total leasing activity in submarket" },
              { label: "Avg Months on Market", value: "4.8", directive: "Average time to lease" },
              { label: "Net Absorption (12 mo)", value: "142,000 SF", directive: "Net change in occupied space" }
            ]
          },
          {
            title: "4.2 Comparable Properties",
            fields: [
              { label: "Rent Comp #1 Address", value: "14502 W Maple Rd", directive: "Most comparable lease comp" },
              { label: "Rent Comp #1 PSF", value: "$26.00/SF", directive: "Achieved rent" },
              { label: "Rent Comp #1 Size", value: "2,200 SF", directive: "Leased square footage" },
              { label: "Rent Comp #1 Date", value: "2024-08", directive: "Lease execution date" },
              { label: "Sale Comp #1 Address", value: "16850 Dodge St", directive: "Most comparable sale" },
              { label: "Sale Comp #1 PSF", value: "$485/SF", directive: "Sale price per SF" },
              { label: "Sale Comp #1 Cap Rate", value: "5.75%", directive: "Capitalization rate at sale" }
            ]
          }
        ]
      },
      {
        id: 5,
        title: "Demographics",
        category: "demographics",
        icon: "M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z",
        color: "#0891B2",
        sources: ["Census", "CoStar", "CenterCheck"],
        sections: [
          {
            title: "5.1 Trade Area Population",
            fields: [
              { label: "1-Mile Population", value: "12,847", directive: "Census population estimate" },
              { label: "3-Mile Population", value: "89,234", directive: "Primary trade area population" },
              { label: "5-Mile Population", value: "198,476", directive: "Extended trade area" },
              { label: "3-Mile Households", value: "34,892", directive: "Primary trade area households" },
              { label: "Annual Pop Growth (3-mi)", value: "+1.8%", directive: "Projected annual growth rate" },
              { label: "Daytime Employees (3-mi)", value: "47,500", directive: "Employment population" },
              { label: "Total Businesses (3-mi)", value: "3,847", directive: "Business establishment count" }
            ]
          },
          {
            title: "5.2 Income & Wealth",
            fields: [
              { label: "Median HH Income (1-mi)", value: "$94,200", directive: "Median household income" },
              { label: "Median HH Income (3-mi)", value: "$87,500", directive: "Primary trade area MHI" },
              { label: "Median HH Income (5-mi)", value: "$82,100", directive: "Extended trade area MHI" },
              { label: "Avg HH Income (3-mi)", value: "$108,400", directive: "Average (captures high earners)" },
              { label: "Per Capita Income (3-mi)", value: "$42,300", directive: "Per person income" },
              { label: "HH Income $100K+ (3-mi)", value: "38.4%", directive: "Percentage of affluent households" },
              { label: "Median Home Value (3-mi)", value: "$342,000", directive: "Median owner-occupied home value" }
            ]
          },
          {
            title: "5.3 Age & Demographics",
            fields: [
              { label: "Median Age (3-mi)", value: "36.4", directive: "Median age of population" },
              { label: "Age 18-34 %", value: "24.8%", directive: "Young adult percentage" },
              { label: "Age 35-54 %", value: "31.2%", directive: "Prime working age" },
              { label: "Age 55+ %", value: "28.4%", directive: "Mature adult percentage" },
              { label: "Bachelor's Degree+ %", value: "48.7%", directive: "College educated percentage" },
              { label: "Female %", value: "51.2%", directive: "Gender distribution" },
              { label: "Demographic Label", value: "Affluent suburban families", directive: "Summary descriptor based on data" }
            ]
          },
          {
            title: "5.4 Consumer Spending",
            fields: [
              { label: "Total Spending (3-mi)", value: "$1.87B", directive: "Aggregate consumer expenditures" },
              { label: "Spending Per HH (3-mi)", value: "$53,600", directive: "Average household spending" },
              { label: "Food & Alcohol Spending", value: "$312M", directive: "Category-specific spending" },
              { label: "Apparel Spending", value: "$78M", directive: "Clothing expenditures" },
              { label: "Entertainment Spending", value: "$142M", directive: "Entertainment category" }
            ]
          }
        ]
      },
      {
        id: 6,
        title: "Traffic & Accessibility",
        category: "physical",
        icon: "M8 7h12m0 0l-4-4m4 4l-4 4m0 6H4m0 0l4 4m-4-4l4-4",
        color: "#EA580C",
        sources: ["CoStar", "DOT"],
        sections: [
          {
            title: "6.1 Traffic Counts",
            fields: [
              { label: "Primary Street Name", value: "Maple Street", directive: "Highest traffic frontage" },
              { label: "Primary Street VPD", value: "28,400", directive: "Vehicles per day from DOT/CoStar" },
              { label: "Primary Count Year", value: "2023", directive: "Year of traffic count" },
              { label: "Secondary Street Name", value: "156th Street", directive: "Secondary frontage" },
              { label: "Secondary Street VPD", value: "18,700", directive: "Vehicles per day" },
              { label: "Combined VPD", value: "47,100", directive: "Sum of all frontage traffic" },
              { label: "Speed Limit (Primary)", value: "40 MPH", directive: "Posted speed limit" },
              { label: "Count Source", value: "Nebraska DOT", directive: "Select: DOT | CoStar | Private | Other" }
            ]
          },
          {
            title: "6.2 Visibility & Signage",
            fields: [
              { label: "Visibility Score", value: "8 / 10", directive: "1-10 scale based on field assessment" },
              { label: "Visible From Primary", value: "Excellent", directive: "Select: Excellent | Good | Fair | Poor" },
              { label: "Setback From Road", value: "45 feet", directive: "Distance from property line to road" },
              { label: "Obstructions", value: "None", directive: "Check: None | Trees | Buildings | Other" },
              { label: "Pylon Sign Permitted", value: "Yes", directive: "Per local sign ordinance" },
              { label: "Max Sign Height", value: "25 feet", directive: "Permitted sign height" },
              { label: "Max Sign SF", value: "80 SF", directive: "Maximum sign face area" }
            ]
          }
        ]
      },
      {
        id: 7,
        title: "Financial Data",
        category: "financial",
        icon: "M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z",
        color: "#16A34A",
        sources: ["CoStar"],
        sections: [
          {
            title: "7.1 Pricing / Listing Information",
            fields: [
              { label: "Asking Price", value: "$2,450,000", directive: "Listed sale price if for sale" },
              { label: "Price Per SF", value: "$1,000/SF", directive: "Asking Price ÷ Building SF" },
              { label: "Sale Type", value: "Investment", directive: "Select: Investment | Owner-User" },
              { label: "Asking Rent PSF", value: "$28.00/SF NNN", directive: "If for lease" },
              { label: "CAM Estimate", value: "$4.50/SF", directive: "Common area maintenance" },
              { label: "Tax Estimate", value: "$3.25/SF", directive: "Property tax pass-through" },
              { label: "Total Occupancy Cost", value: "$35.75/SF", directive: "Rent + CAM + Tax + Insurance" },
              { label: "Days on Market", value: "—", directive: "Days since listing (if applicable)" }
            ]
          },
          {
            title: "7.2 Sale History",
            fields: [
              { label: "Last Sale Date", value: "2019-02-28", directive: "Most recent arm's length sale" },
              { label: "Last Sale Price", value: "$1,850,000", directive: "Recorded sale price" },
              { label: "Last Sale PSF", value: "$755/SF", directive: "Sale price ÷ Building SF" },
              { label: "Buyer", value: "Maple Street Properties LLC", directive: "Purchasing entity" },
              { label: "Seller", value: "Development Partners Inc", directive: "Selling entity" }
            ]
          },
          {
            title: "7.3 Tax Assessment",
            fields: [
              { label: "Assessment Year", value: "2024", directive: "Tax year of assessment" },
              { label: "Total Assessed Value", value: "$1,420,000", directive: "Combined land + improvement" },
              { label: "Land Assessed Value", value: "$580,000", directive: "Land only assessment" },
              { label: "Improvement Value", value: "$840,000", directive: "Building/improvements assessment" },
              { label: "Annual Taxes", value: "$32,450", directive: "Annual property tax bill" },
              { label: "Tax Per SF", value: "$13.24/SF", directive: "Taxes ÷ Building SF" }
            ]
          }
        ]
      },
      {
        id: 8,
        title: "Sales Performance",
        category: "performance",
        icon: "M13 7h8m0 0v8m0-8l-8 8-4-4-6 6",
        color: "#9333EA",
        sources: ["CenterCheck"],
        sections: [
          {
            title: "8.1 Performance Summary",
            fields: [
              { label: "Report Period", value: "Oct 2023 - Sep 2024", directive: "12-month data period" },
              { label: "Card Sales (Annual)", value: "$2,847,000", directive: "Total card transaction revenue" },
              { label: "YoY Sales Growth", value: "+12.4%", directive: "Change from prior 12 months" },
              { label: "Transaction Count", value: "186,000", directive: "Annual transaction volume" },
              { label: "Average Order Value", value: "$15.31", directive: "Card Sales ÷ Transactions" },
              { label: "Unique Customers", value: "42,800", directive: "Distinct cardholders" },
              { label: "Customer Frequency", value: "4.35", directive: "Avg visits per customer" },
              { label: "Nationwide Rank", value: "94th percentile", directive: "Rank vs all brand locations nationally" },
              { label: "State Rank", value: "96th percentile", directive: "Rank vs all brand locations in state" }
            ]
          },
          {
            title: "8.2 Trade Area Capture",
            fields: [
              { label: "Active Zip Codes", value: "8", directive: "Count of zips with >1% of sales" },
              { label: "Most Active Zip", value: "68116", directive: "Zip code with highest sales %" },
              { label: "Top Zip Sales %", value: "34.2%", directive: "Concentration in #1 zip" },
              { label: "Trade Area Classification", value: "Regional Draw", directive: "Hyper-Local (1-3 zips, >70%) | Concentrated (4-7, 40-70%) | Regional (8-12, 20-40%) | Diffuse (13+, <20%)" },
              { label: "Concentration Risk Score", value: "32 / 100", directive: "Lower = less concentrated = lower risk" }
            ]
          },
          {
            title: "8.3 Monthly Trends",
            fields: [
              { label: "Peak Month", value: "December", directive: "Highest sales month" },
              { label: "Peak Month Sales", value: "$284,000", directive: "Sales in peak month" },
              { label: "Trough Month", value: "February", directive: "Lowest sales month" },
              { label: "Trough Month Sales", value: "$198,000", directive: "Sales in trough month" },
              { label: "Seasonality Index", value: "1.43", directive: "Peak ÷ Trough (higher = more seasonal)" },
              { label: "Trend Direction", value: "Growing", directive: "Select: Growing | Stable | Declining" }
            ]
          }
        ]
      },
      {
        id: 9,
        title: "Customer Intelligence",
        category: "performance",
        icon: "M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z",
        color: "#0D9488",
        sources: ["CenterCheck"],
        sections: [
          {
            title: "9.1 Shopper Demographics",
            fields: [
              { label: "Shopper Age 25-34", value: "28.4%", directive: "% of actual shoppers in age bracket" },
              { label: "Shopper Age 35-44", value: "24.2%", directive: "% of actual shoppers" },
              { label: "Shopper Age 45-54", value: "21.8%", directive: "% of actual shoppers" },
              { label: "Shopper Female %", value: "58.4%", directive: "Gender of actual shoppers" },
              { label: "Shopper Income $100K+", value: "42.1%", directive: "% earning $100K+ household income" },
              { label: "Shopper Income Label", value: "Upper-middle income", directive: "Summary based on income distribution" },
              { label: "Shopper Has Kids %", value: "38.7%", directive: "% with children in household" }
            ]
          },
          {
            title: "9.2 Shopper vs. Resident Comparison",
            fields: [
              { label: "Income Variance", value: "+18.4%", directive: "Shopper income vs. resident income (positive = shoppers richer)" },
              { label: "Age Variance", value: "-2.1 years", directive: "Shopper median age vs. resident (negative = younger shoppers)" },
              { label: "Female Variance", value: "+7.2%", directive: "Shopper female % vs. resident %" },
              { label: "Key Insight", value: "Attracts higher income, younger shoppers than local demographics suggest", directive: "Primary takeaway from comparison" }
            ]
          },
          {
            title: "9.3 Customer Journey",
            fields: [
              { label: "Previous Location #1", value: "Hy-Vee (18.4%)", directive: "Most common prior shopping stop" },
              { label: "Previous Location #2", value: "Target (12.1%)", directive: "Second most common prior stop" },
              { label: "Subsequent Location #1", value: "Standalone Trip (58.2%)", directive: "Most common next action" },
              { label: "Subsequent Location #2", value: "Costco (8.7%)", directive: "Second most common next stop" },
              { label: "Trip Type", value: "Convenience", directive: "Select: Destination (<5%) | Convenience (5-15%) | Trip-Chain (>15%)" },
              { label: "Co-Shopping Rate", value: "41.8%", directive: "% of visits that are part of multi-stop trip" }
            ]
          }
        ]
      },
      {
        id: 10,
        title: "Competitive Intelligence",
        category: "performance",
        icon: "M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z",
        color: "#DB2777",
        sources: ["CenterCheck", "Analysis"],
        sections: [
          {
            title: "10.1 Competitor Comparison",
            fields: [
              { label: "Subject vs. Nearest Comp", value: "+8.4%", directive: "Sales variance vs. nearest competitor" },
              { label: "Subject vs. Market Avg", value: "+14.2%", directive: "Sales vs. submarket average" },
              { label: "Strongest Metric", value: "YoY Growth (+12.4%)", directive: "Best performing dimension" },
              { label: "Weakest Metric", value: "Customer Frequency (4.35)", directive: "Lowest performing dimension" },
              { label: "Competitive Advantage", value: "Drive-through speed, morning traffic exposure", directive: "Qualitative assessment of differentiation" }
            ]
          },
          {
            title: "10.2 Co-Tenancy Relationships",
            fields: [
              { label: "Top Complementary #1", value: "Hy-Vee (Score: 9/10)", directive: "Highest synergy co-tenant" },
              { label: "Top Complementary #2", value: "Target (Score: 8/10)", directive: "Second highest synergy" },
              { label: "Top Complementary #3", value: "Costco (Score: 8/10)", directive: "Third highest synergy" },
              { label: "Competitive Co-Tenant", value: "Dunkin' (Score: 3/10)", directive: "Lowest synergy / competitive conflict" }
            ]
          }
        ]
      },
      {
        id: 11,
        title: "Contacts & Ownership",
        category: "identity",
        icon: "M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z",
        color: "#4B5563",
        sources: ["CoStar"],
        sections: [
          {
            title: "11.1 Ownership Information",
            fields: [
              { label: "True Owner", value: "Maple Street Properties LLC", directive: "Beneficial owner (may differ from recorded)" },
              { label: "Owner Type", value: "Private Equity", directive: "Select: Individual | Company | REIT | PE | Developer | Government" },
              { label: "Owner Since", value: "2019-02-28", directive: "Date of acquisition" },
              { label: "Recorded Owner", value: "MSP Holdings LLC", directive: "Name on title (if different)" },
              { label: "Mailing Address", value: "1234 Financial Dr, Suite 500, Dallas, TX 75201", directive: "Tax bill mailing address" }
            ]
          },
          {
            title: "11.2 Leasing & Sales Contacts",
            fields: [
              { label: "Leasing Company", value: "N/A (Single Tenant NNN)", directive: "Leasing agent firm" },
              { label: "Property Manager", value: "Self-Managed", directive: "PM company name" },
              { label: "Sales Broker", value: "CBRE", directive: "Listing broker if for sale" },
              { label: "Sales Broker Contact", value: "John Smith, (402) 555-1234", directive: "Name and phone" }
            ]
          }
        ]
      },
      {
        id: 12,
        title: "Risk Assessment",
        category: "financial",
        icon: "M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z",
        color: "#B45309",
        sources: ["CoStar", "FEMA"],
        sections: [
          {
            title: "12.1 Flood Risk",
            fields: [
              { label: "FEMA Flood Zone", value: "Zone X", directive: "From FEMA flood maps" },
              { label: "Zone Description", value: "Area of Minimal Flood Hazard", directive: "Plain language zone meaning" },
              { label: "In Special Flood Hazard Area", value: "No", directive: "Yes if Zone A or V" },
              { label: "Flood Insurance Required", value: "No", directive: "Required for SFHA properties" },
              { label: "FIRM Panel Number", value: "31055C0185J", directive: "Flood Insurance Rate Map panel" }
            ]
          },
          {
            title: "12.2 Environmental & Other Risks",
            fields: [
              { label: "Phase I ESA Completed", value: "Yes", directive: "Environmental site assessment status" },
              { label: "Phase I Date", value: "2018-12-15", directive: "Date of environmental study" },
              { label: "Known Contamination", value: "No", directive: "Any identified environmental issues" },
              { label: "Seismic Zone", value: "Low Risk", directive: "Earthquake hazard level" },
              { label: "Hurricane Risk", value: "N/A", directive: "Select: High | Medium | Low | N/A" }
            ]
          }
        ]
      },
      {
        id: 13,
        title: "Data Quality & Metadata",
        category: "calculated",
        icon: "M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z",
        color: "#6366F1",
        sources: ["System"],
        sections: [
          {
            title: "13.1 Data Sources & Freshness",
            fields: [
              { label: "Profile Created", value: "2024-10-15", directive: "Date profile was created" },
              { label: "Profile Created By", value: "J. Anderson", directive: "Analyst who created profile" },
              { label: "Last Updated", value: "2024-11-28", directive: "Most recent update date" },
              { label: "Updated By", value: "M. Chen", directive: "Last analyst to update" },
              { label: "Profile Version", value: "3.2", directive: "Version number" },
              { label: "Data Completeness", value: "94%", directive: "% of fields populated" },
              { label: "Next Update Due", value: "2025-02-15", directive: "Scheduled refresh date" }
            ]
          },
          {
            title: "13.2 Data Quality Flags",
            fields: [
              { label: "Traffic Data Outdated", value: "No", directive: "Flag if count >3 years old" },
              { label: "Sales Data Available", value: "Yes", directive: "CenterCheck data present" },
              { label: "Zoning Confirmed", value: "Yes", directive: "Verified with municipality" },
              { label: "Field Visit Completed", value: "Yes", directive: "On-site inspection done" },
              { label: "Field Visit Date", value: "2024-10-22", directive: "Date of site visit" },
              { label: "Coordinates Validated", value: "High (Rooftop)", directive: "Geocode confidence level" }
            ]
          }
        ]
      },
      {
        id: 14,
        title: "Calculated Metrics (DASSB)",
        category: "calculated",
        icon: "M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z",
        color: "#7C3AED",
        sources: ["Calculated"],
        sections: [
          {
            title: "14.1 Normalization Calculations",
            fields: [
              { label: "Sales Per Capita", value: "$31.89", formula: "Card_Sales / Trade_Area_3mi_Population = $2,847,000 / 89,234", directive: "Market penetration efficiency" },
              { label: "Sales Per Zip", value: "$355,875", formula: "Card_Sales / Total_Active_Zip_Codes = $2,847,000 / 8", directive: "Geographic efficiency" },
              { label: "Transaction Density", value: "2.08", formula: "Transactions / Trade_Area_3mi_Population = 186,000 / 89,234", directive: "Transactions per capita" },
              { label: "Customer Conversion Rate", value: "47.9%", formula: "(Unique_Customers / Trade_Area_3mi_Population) × 100 = (42,800 / 89,234) × 100", directive: "Market capture rate" },
              { label: "AOV Index", value: "1.12", formula: "Location_AOV / Brand_Average_AOV = $15.31 / $13.65", directive: ">1.0 = above average ticket" },
              { label: "Growth Momentum", value: "+153.76", formula: "Current_YoY × Prior_YoY = 12.4% × 12.4% (positive = accelerating)", directive: "Positive = growth accelerating" }
            ]
          },
          {
            title: "14.2 Market Normalization",
            fields: [
              { label: "Traffic Index", value: "1.34", formula: "Site_VPD / Market_Avg_VPD = 47,100 / 35,200", directive: ">1.0 = above average traffic" },
              { label: "Income Index", value: "1.18", formula: "Trade_Area_MHI / National_MHI = $87,500 / $74,580", directive: ">1.0 = above average income" },
              { label: "Rent Index", value: "1.14", formula: "Site_Rent_PSF / Market_Avg_Rent = $28.00 / $24.50", directive: ">1.0 = premium rent area" }
            ]
          },
          {
            title: "14.3 Scoring Outputs",
            fields: [
              { label: "Revenue Potential Score", value: "88 / 100", directive: "Based on sales, traffic, demographics" },
              { label: "Traffic Exposure Score", value: "92 / 100", directive: "Based on VPD and visibility" },
              { label: "Demo Alignment Score", value: "84 / 100", directive: "Target customer match" },
              { label: "Competitive Position Score", value: "72 / 100", directive: "Based on proximity band and pressure" },
              { label: "Site Quality Score", value: "86 / 100", directive: "Physical attributes assessment" },
              { label: "Growth Trajectory Score", value: "94 / 100", directive: "Based on YoY and momentum" },
              { label: "Concentration Risk Score", value: "78 / 100", directive: "Trade area diversity (higher = better)" },
              { label: "COMPOSITE SCORE", value: "85.8 / 100", formula: "(Revenue×0.25)+(Traffic×0.15)+(Demo×0.15)+(Competitive×0.15)+(Quality×0.10)+(Growth×0.10)+(Concentration×0.10)", directive: "Weighted total score" },
              { label: "Tier Assignment", value: "Tier 1A", directive: "1A (≥85) | 1B (75-84) | 2 (65-74) | 3 (<65)" }
            ]
          },
          {
            title: "14.4 Revenue Projections",
            fields: [
              { label: "Translation Factor", value: "0.67", formula: "Client_Nat_Avg / Competitor_Nat_Avg", directive: "Ratio for brand translation" },
              { label: "Demographic Multiplier", value: "1.08", formula: "(Trade_Area_MHI / $85,000)^0.4", directive: "Income-based adjustment" },
              { label: "Competition Adjustment", value: "1.04", directive: "Based on proximity band (Optimal)" },
              { label: "Site Quality Factor", value: "1.02", directive: "Visibility/access premium" },
              { label: "Market Maturity Y1", value: "0.88", directive: "First year ramp factor" },
              { label: "Market Maturity Y2", value: "1.00", directive: "Stabilized factor" },
              { label: "Market Maturity Y3", value: "1.12", directive: "Mature location premium" },
              { label: "Projected Revenue Y1", value: "$1,532,000", directive: "Year 1 estimate" },
              { label: "Projected Revenue Y2", value: "$1,741,000", directive: "Year 2 stabilized" },
              { label: "Projected Revenue Y3", value: "$1,950,000", directive: "Year 3 mature" },
              { label: "Projection Confidence", value: "High", directive: "Based on data quality and comparable count" }
            ]
          }
        ]
      }
    ];

    const mapCatalog = [
      { category: "Performance Comparison", maps: [
        { name: "Bubble Map with Multi-Variable Encoding", description: "Size = sales, color = growth, opacity = rank", bestFor: "Executive overview" },
        { name: "Side-by-Side Split Screen", description: "Synchronized zoom/pan comparison", bestFor: "Finalist comparison" },
        { name: "Ranked Performance Gradient", description: "All locations colored by tier", bestFor: "Portfolio assessment" }
      ]},
      { category: "Trade Area & Capture Zone", maps: [
        { name: "Heat Map of Sales Concentration", description: "Zip codes shaded by sales %", bestFor: "Geographic patterns" },
        { name: "Isochrone Drive Time Map", description: "5/10/15/20-minute rings", bestFor: "Drive-time validation" },
        { name: "3D Extrusion Map", description: "3D columns = sales volume", bestFor: "Stakeholder presentations" }
      ]},
      { category: "Demographic Overlay", maps: [
        { name: "Income Stratification Map", description: "Income layers with shopper overlay", bestFor: "Targeting" },
        { name: "Age Distribution Hex Map", description: "Hexes colored by age group", bestFor: "Age-appropriate sites" },
        { name: "Demographic Mismatch Alert", description: "Flags where shoppers ≠ residents", bestFor: "Underserved segments" }
      ]},
      { category: "Competitive Landscape", maps: [
        { name: "Customer Journey Flow (Sankey)", description: "Animated shopping flows", bestFor: "Co-tenancy strategy" },
        { name: "Competitive Threat Radius", description: "Rings showing threat levels", bestFor: "Defensive selection" },
        { name: "Market Saturation Index", description: "Stores vs. supportable ratio", bestFor: "White space analysis" }
      ]},
      { category: "Decision Support", maps: [
        { name: "Multi-Criteria Weighted Score", description: "Real-time weight adjustment", bestFor: "Decision workshops" },
        { name: "Go/No-Go Traffic Light", description: "Green/yellow/red by criteria", bestFor: "Pipeline screening" },
        { name: "Before/After Coverage", description: "Slider comparison", bestFor: "Expansion planning" }
      ]}
    ];

    const formulas = [
      { name: "Sales Per Capita", formula: "Card_Sales ÷ Trade_Area_Population", description: "Market penetration efficiency" },
      { name: "Sales Per Zip", formula: "Card_Sales ÷ Active_Zip_Codes", description: "Geographic efficiency" },
      { name: "Transaction Density", formula: "Transactions ÷ Trade_Area_Population", description: "Visit frequency per capita" },
      { name: "Customer Conversion", formula: "(Unique_Customers ÷ Trade_Area_Population) × 100", description: "Market capture rate" },
      { name: "Growth Momentum", formula: "Current_YoY% × Previous_YoY%", description: "Positive = accelerating growth" },
      { name: "Translation Factor", formula: "Client_National_Avg ÷ Competitor_National_Avg", description: "Brand performance ratio" },
      { name: "Demographic Multiplier", formula: "(Trade_Area_MHI ÷ $85,000) ^ 0.4", description: "Income adjustment factor" },
      { name: "Composite Score", formula: "(Growth×0.25) + (AOV×0.20) + (Rank×0.20) + (CustGrowth×0.15) + (TradeArea×0.10) + (Concentration×0.10)", description: "Weighted site ranking" }
    ];

    // ============================================
    // STATE MANAGEMENT
    // ============================================
    
    let expandedSteps = {};
    let expandedModules = {};
    let currentProfileFilter = 'all';

    // ============================================
    // RENDER FUNCTIONS
    // ============================================

    function showSection(sectionId) {
      document.querySelectorAll('main > section').forEach(s => s.classList.add('hidden'));
      document.getElementById('section-' + sectionId).classList.remove('hidden');
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
        if (item.dataset.section === sectionId) item.classList.add('active');
      });
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function toggleMobileMenu() {
      const nav = document.getElementById('mobileNav');
      const menuIcon = document.getElementById('menuIcon');
      const closeIcon = document.getElementById('closeIcon');
      nav.classList.toggle('hidden');
      menuIcon.classList.toggle('hidden');
      closeIcon.classList.toggle('hidden');
    }

    function toggleStep(stepId) {
      expandedSteps[stepId] = !expandedSteps[stepId];
      renderSteps();
    }

    function toggleModule(moduleId) {
      expandedModules[moduleId] = !expandedModules[moduleId];
      renderProfile();
    }

    function showProfileModule(category) {
      currentProfileFilter = category;
      document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.dataset.module === category) btn.classList.add('active');
      });
      renderProfile();
    }

    function renderSteps() {
      const container = document.getElementById('stepsContainer');
      container.innerHTML = steps.map(step => `
        <div class="step-card mb-4 rounded-xl overflow-hidden shadow-lg" style="border-left: 4px solid ${step.color}">
          <button onclick="toggleStep(${step.id})" class="w-full p-5 bg-white flex items-center justify-between text-left hover:bg-gray-50 transition-colors">
            <div class="flex items-center gap-4">
              <div class="w-12 h-12 rounded-xl flex items-center justify-center" style="background-color: ${step.color}15">
                <span class="text-lg font-bold" style="color: ${step.color}">${step.id}</span>
              </div>
              <div>
                <div class="flex items-center gap-2 mb-1">
                  <span class="text-xs font-bold px-2 py-0.5 rounded-full text-white" style="background-color: ${step.color}">STEP ${step.id}</span>
                  <span class="text-xs text-gray-500 font-medium">${step.phase}</span>
                </div>
                <h3 class="text-lg font-bold text-gray-800">${step.title}</h3>
              </div>
            </div>
            <svg class="w-6 h-6 text-gray-400 transition-transform ${expandedSteps[step.id] ? 'rotate-180' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </button>
          ${expandedSteps[step.id] ? `
            <div class="expand-content bg-gray-50 border-t border-gray-100">
              <div class="p-5 bg-gradient-to-r from-gray-800 to-gray-700 text-white">
                <div class="text-xs font-bold text-gray-300 mb-1">KEY ACTION</div>
                <p class="text-sm leading-relaxed">${step.keyAction}</p>
              </div>
              <div class="p-5 grid grid-cols-1 md:grid-cols-2 gap-4">
                <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                  <div class="text-xs font-bold text-gray-600 mb-2">TARGETED INSIGHT</div>
                  <p class="text-sm text-gray-700">${step.targetedInsight}</p>
                </div>
                <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                  <div class="text-xs font-bold text-gray-600 mb-2">DIRECTIVE</div>
                  <p class="text-sm text-gray-700">${step.directive}</p>
                </div>
              </div>
              <div class="px-5 pb-5 space-y-3">
                <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-100">
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <div><div class="text-xs font-bold text-green-600 mb-1">INPUT</div><p class="text-sm text-gray-600">${step.input}</p></div>
                    <div><div class="text-xs font-bold text-blue-600 mb-1">OUTPUT</div><p class="text-sm text-gray-600">${step.output}</p></div>
                    <div><div class="text-xs font-bold text-purple-600 mb-1">DELIVERABLE</div><p class="text-sm text-gray-600">${step.deliverable}</p></div>
                  </div>
                </div>
                <div class="bg-white rounded-lg p-4 shadow-sm border border-gray-100" style="border-left: 3px solid ${step.color}">
                  <div class="flex flex-wrap gap-4 text-sm">
                    <div><span class="font-bold text-gray-500">Map Type:</span> <span class="text-gray-700">${step.mapType}</span></div>
                    <div><span class="font-bold text-gray-500">Best For:</span> <span style="color: ${step.color}" class="font-medium">${step.bestFor}</span></div>
                  </div>
                </div>
              </div>
            </div>
          ` : ''}
        </div>
      `).join('');
    }

    function getSourceBadge(source) {
      const classes = {
        'CoStar': 'source-costar',
        'CenterCheck': 'source-centercheck',
        'Census': 'source-census',
        'Google': 'source-google',
        'Calculated': 'source-calculated',
        'System': 'source-calculated',
        'DOT': 'source-census',
        'FEMA': 'source-census',
        'Analysis': 'source-calculated'
      };
      return `<span class="data-source-badge ${classes[source] || 'source-costar'}">${source}</span>`;
    }

    function renderProfile() {
      const container = document.getElementById('profileContainer');
      const filteredModules = currentProfileFilter === 'all' 
        ? profileModules 
        : profileModules.filter(m => m.category === currentProfileFilter);
      
      container.innerHTML = filteredModules.map(module => `
        <div class="mb-6">
          <div class="module-header cursor-pointer" onclick="toggleModule(${module.id})" style="background: linear-gradient(135deg, ${module.color} 0%, ${module.color}CC 100%)">
            <div class="w-10 h-10 rounded-lg bg-white/20 flex items-center justify-center flex-shrink-0">
              <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="${module.icon}"></path></svg>
            </div>
            <div class="flex-1">
              <div class="flex items-center gap-2 mb-1">
                <span class="text-white/80 text-xs font-bold">MODULE ${module.id}</span>
                ${module.sources.map(s => getSourceBadge(s)).join(' ')}
              </div>
              <h3 class="text-lg font-bold text-white">${module.title}</h3>
            </div>
            <svg class="w-6 h-6 text-white/80 transition-transform ${expandedModules[module.id] ? 'rotate-180' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path></svg>
          </div>
          ${expandedModules[module.id] !== false ? `
            <div class="module-content expand-content">
              ${module.sections.map(section => `
                <div class="mb-6 last:mb-0">
                  <h4 class="text-sm font-bold text-gray-800 mb-3 flex items-center gap-2">
                    <div class="w-2 h-2 rounded-full" style="background-color: ${module.color}"></div>
                    ${section.title}
                  </h4>
                  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3">
                    ${section.fields.map(field => `
                      <div class="profile-field">
                        <div class="field-label">${field.label}</div>
                        <div class="field-value">${field.value}</div>
                        ${field.formula ? `<div class="formula-box mt-2 text-xs">${field.formula}</div>` : ''}
                        <div class="field-directive">${field.directive}</div>
                      </div>
                    `).join('')}
                  </div>
                </div>
                <div class="section-divider"></div>
              `).join('')}
            </div>
          ` : ''}
        </div>
      `).join('');
      
      // Auto-expand all modules by default
      if (Object.keys(expandedModules).length === 0) {
        profileModules.forEach(m => expandedModules[m.id] = true);
      }
    }

    function renderMapCatalog() {
      const container = document.getElementById('mapCatalogContainer');
      container.innerHTML = mapCatalog.map(category => `
        <div class="bg-white rounded-xl shadow-sm overflow-hidden mb-4">
          <div class="bg-gradient-to-r from-gray-800 to-gray-700 px-5 py-3">
            <h3 class="text-white font-bold">${category.category} Maps</h3>
          </div>
          <div class="divide-y divide-gray-100">
            ${category.maps.map(map => `
              <div class="p-4 hover:bg-gray-50 transition-colors">
                <div class="flex items-start justify-between gap-4">
                  <div class="flex items-start gap-3">
                    <div class="w-8 h-8 rounded-lg bg-blue-50 flex items-center justify-center flex-shrink-0">
                      <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"></path></svg>
                    </div>
                    <div>
                      <h4 class="font-bold text-gray-800">${map.name}</h4>
                      <p class="text-sm text-gray-600">${map.description}</p>
                    </div>
                  </div>
                  <span class="text-xs bg-emerald-50 text-emerald-700 px-2 py-1 rounded-full whitespace-nowrap">${map.bestFor}</span>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
      `).join('');
    }

    function renderFormulas() {
      const container = document.getElementById('formulasContainer');
      container.innerHTML = `
        <div class="bg-white rounded-xl shadow-sm overflow-hidden">
          <div class="divide-y divide-gray-100">
            ${formulas.map(f => `
              <div class="p-5 hover:bg-gray-50 transition-colors">
                <div class="flex items-start gap-4">
                  <div class="w-10 h-10 rounded-lg bg-purple-50 flex items-center justify-center flex-shrink-0">
                    <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 7h6m0 10v-3m-3 3h.01M9 17h.01M9 14h.01M12 14h.01M15 11h.01M12 11h.01M9 11h.01M7 21h10a2 2 0 002-2V5a2 2 0 00-2-2H7a2 2 0 00-2 2v14a2 2 0 002 2z"></path></svg>
                  </div>
                  <div class="flex-1">
                    <h3 class="font-bold text-gray-800 mb-1">${f.name}</h3>
                    <div class="formula-box mb-2">${f.formula}</div>
                    <p class="text-sm text-gray-600">${f.description}</p>
                  </div>
                </div>
              </div>
            `).join('')}
          </div>
        </div>
        
        <div class="bg-gradient-to-r from-blue-600 to-emerald-500 rounded-xl p-6 text-white mt-6">
          <h3 class="font-bold text-lg mb-2">Master Formula: Composite Site Score</h3>
          <p class="opacity-90 text-sm mb-4">The weighted combination that produces defensible site rankings</p>
          <div class="bg-white/20 backdrop-blur-sm rounded-lg p-4 mono text-sm">
            Score = (YoY_Growth × 0.25) + (AOV × 0.20) + (Brand_Rank × 0.20) + (Customer_Growth × 0.15) + (Trade_Area × 0.10) + (Concentration × 0.10)
          </div>
        </div>
        
        <div class="bg-white rounded-xl shadow-sm p-6 mt-6">
          <h3 class="font-bold text-gray-800 mb-4">Revenue Projection Formula</h3>
          <div class="formula-box text-center">
            Year 2 Revenue = Base Volume × Demographic Multiplier × Competition Factor × Site Quality Factor × Seasonal Adjustment × Market Maturity
          </div>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
            <div class="bg-gray-50 rounded-lg p-3">
              <div class="text-xs font-bold text-gray-500 mb-1">Base Volume</div>
              <div class="mono text-sm">(VPD × 0.0085 × 365 × $6.50)</div>
            </div>
            <div class="bg-gray-50 rounded-lg p-3">
              <div class="text-xs font-bold text-gray-500 mb-1">Demo Multiplier</div>
              <div class="mono text-sm">(MHI / $85,000) ^ 0.4</div>
            </div>
            <div class="bg-gray-50 rounded-lg p-3">
              <div class="text-xs font-bold text-gray-500 mb-1">Maturity Curve</div>
              <div class="mono text-sm">Y1: 0.88 | Y2: 1.00 | Y3: 1.12</div>
            </div>
          </div>
        </div>
      `;
    }

    // ============================================
    // SCROLL PROGRESS
    // ============================================
    
    window.addEventListener('scroll', () => {
      const scrollTop = window.scrollY;
      const docHeight = document.documentElement.scrollHeight - window.innerHeight;
      const progress = (scrollTop / docHeight) * 100;
      document.querySelector('.progress-bar').style.width = progress + '%';
    });

    // ============================================
    // INITIALIZATION
    // ============================================
    
    document.addEventListener('DOMContentLoaded', () => {
      // Initialize all modules as expanded
      profileModules.forEach(m => expandedModules[m.id] = true);
      
      renderSteps();
      renderProfile();
      renderMapCatalog();
      renderFormulas();
      showSection('overview');
    });
  </script>
</body>
</html>
